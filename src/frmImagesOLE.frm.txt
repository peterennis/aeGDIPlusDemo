Version =20
VersionRequired =20
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowEdits = NotDefault
    DefaultView =0
    ScrollBars =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =8505
    DatasheetFontHeight =11
    ItemSuffix =9
    Right =15720
    Bottom =11835
    DatasheetGridlinesColor =15062992
    OnUnload ="[Event Procedure]"
    RecSrcDt = Begin
        0xb950e554028ee340
    End
    GUID = Begin
        0x5ea28804a2d0524e963b868579a7fd93
    End
    NameMap = Begin
    End
    RecordSource ="tblOLE"
    Caption ="Bilder aus OLE-BLOBs"
    OnCurrent ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
    End
    PrtDevMode = Begin
    End
    PrtDevNames = Begin
    End
    AllowDatasheetView =0
    FilterOnLoad =0
    OrderByOnLoad =0
    OrderByOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    AllowLayoutView =0
    DatasheetAlternateBackColor =16053492
    DatasheetGridlinesColor12 =15062992
    FitToScreen =1
    PrtDevModeW = Begin
    End
    PrtDevNamesW = Begin
    End
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            Width =1701
            Height =1701
        End
        Begin TextBox
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            BorderColor =12632256
            FontName ="Calibri"
            AsianLineBreak =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            Width =4536
            Height =2835
        End
        Begin CustomControl
            SpecialEffect =2
            Width =4536
            Height =2835
        End
        Begin Attachment
            BackStyle =0
            BorderLineStyle =0
            PictureSizeMode =3
            Width =1701
            Height =1701
            BorderColor =12632256
            LabelX =-1701
        End
        Begin Section
            Height =4845
            Name ="Detailbereich"
            GUID = Begin
                0x44edf98b005e4b45a9dbc6c89266e08f
            End
            Begin
                Begin CustomControl
                    Enabled = NotDefault
                    TabStop = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =4545
                    Top =675
                    Width =3402
                    Height =3402
                    AutoActivate =1
                    TabIndex =1
                    Name ="ctlImg2"
                    OleData = Begin
                    End
                    OLEClass ="Microsoft Forms 2.0"
                    Class ="Forms.Image.1"
                    GUID = Begin
                        0xa1a580585081a041a07a0f1a7efa9742
                    End

                    LayoutCachedLeft =4545
                    LayoutCachedTop =675
                    LayoutCachedWidth =7947
                    LayoutCachedHeight =4077
                End
                Begin CustomControl
                    Enabled = NotDefault
                    TabStop = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =93
                    Left =570
                    Top =675
                    Width =3402
                    Height =3402
                    AutoActivate =1
                    Name ="ctlImg"
                    OleData = Begin
                    End
                    OLEClass ="Microsoft Forms 2.0"
                    Class ="Forms.Image.1"
                    GUID = Begin
                        0x162cb30c0f6f1a4db65b49a8c31294d4
                    End

                    LayoutCachedLeft =570
                    LayoutCachedTop =675
                    LayoutCachedWidth =3972
                    LayoutCachedHeight =4077
                End
                Begin CustomControl
                    Visible = NotDefault
                    Enabled = NotDefault
                    SizeMode =1
                    SpecialEffect =0
                    OverlapFlags =247
                    Left =570
                    Top =675
                    Width =3405
                    Height =3405
                    AutoActivate =1
                    TabIndex =2
                    Name ="ctlList"
                    OleData = Begin
                    End
                    OLEClass ="ListViewCtrl"
                    Class ="MSComctlLib.ListViewCtrl.2"
                    GUID = Begin
                        0x52ebf9524828404080ff405414fe44a4
                    End

                    LayoutCachedLeft =570
                    LayoutCachedTop =675
                    LayoutCachedWidth =3975
                    LayoutCachedHeight =4080
                End
                Begin Label
                    Visible = NotDefault
                    OverlapFlags =85
                    TextAlign =2
                    Left =570
                    Top =4140
                    Width =3405
                    Height =285
                    Name ="LblDrop"
                    Caption ="Eine Bilddatei ins Feld  ziehen"
                    GUID = Begin
                        0x062244d705e4704c80098f574ba646e3
                    End
                    LayoutCachedLeft =570
                    LayoutCachedTop =4140
                    LayoutCachedWidth =3975
                    LayoutCachedHeight =4425
                End
                Begin Label
                    OverlapFlags =85
                    Left =570
                    Top =360
                    Width =3405
                    Height =270
                    Name ="LblInfo"
                    Caption ="Größe"
                    GUID = Begin
                        0x592abb2b9be1a64dac9b524b4860f0ad
                    End
                    LayoutCachedLeft =570
                    LayoutCachedTop =360
                    LayoutCachedWidth =3975
                    LayoutCachedHeight =630
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private bNew As Boolean

Private Sub Form_Current()
    Dim PicSize As mdlOGL0710.TSize
    
    If bNew Then Exit Sub
    
    Set Me!ctlImg.Object.Picture = Nothing
    Set Me!ctlImg2.Object.Picture = Nothing
    Me!LblInfo.Caption = ""
    
    If Me.NewRecord Then
        Me!ctlList.Visible = True
        Me!LblDrop.Visible = True
        Exit Sub
    Else
        Me!ctlList.Visible = False
        Me!LblDrop.Visible = False
    End If
    
    Set Me!ctlImg.Object.Picture = OLEFieldToPicture("tblOLE", "ImageName", Me!ImageName, "BLOB")   'OGL-Funktion
    PicSize = GetDimensionsGDIP(Me!ctlImg.Object.Picture)   'OGL-Funktion
    Me!LblInfo.Caption = PicSize.X & " x " & PicSize.Y
    Set Me!ctlImg2.Object.Picture = ResampleGDIP(Me!ctlImg.Object.Picture, 100, 100, True)  'OGL-Funktion

End Sub

Private Sub Form_Unload(Cancel As Integer)
    ShutDownGDIP
End Sub

Private Sub ctlList_OLEDragDrop(Data As Object, Effect As Long, _
                                Button As Integer, Shift As Integer, X As Single, Y As Single)
    Dim oPic As StdPicture
    Dim sFile As String
        
    sFile = Data.Files(1)
    Set oPic = LoadPictureGDIP(sFile)   'OGL-Funktion
    If Not oPic Is Nothing Then
        Me!ImageName = Mid(sFile, InStrRev(sFile, "\") + 1)
        Me!BLOB.Value = ArrayFromPicture(oPic, pictypePNG)  'OGL-Funktion
        Me.Dirty = False
        Set oPic = Nothing
        bNew = True
        Me.Requery
        bNew = False
        DoCmd.GoToRecord acDataForm, Me.Name, acLast
    Else
        MsgBox "Ungültige Bilddatei"
    End If
End Sub
